<apex:page standardController="Account" extensions="EPO_Controller_Account" showHeader="false">
    <style>
        body {
            background-color: #F0F8FF;
        }
        .odd {background-color: #D2F1F7;}
        .even {background-color: #B6E8F2;}
        td {padding: 8px 0px 8px 8px;}
    </style>
    <body>
        <apex:form >
            <apex:outputPanel layout="block" rendered="{!oppDataPresent}">
                <apex:pageBlock >
                    <apex:pageBlockSection title="EPO Summary (for all Opportunities)" columns="2" collapsible="false">
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel >Total Amount Paid:</apex:outputLabel>
                            <apex:outputLabel >${!amountPaid}</apex:outputLabel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel >Last Payment Amount:</apex:outputLabel>
                            <apex:outputLabel >${!lastPaymentAmount}</apex:outputLabel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel >Total Remaining Amount Owed:</apex:outputLabel>
                            <apex:outputLabel >${!amountOwed}</apex:outputLabel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel >Last Payment Date:</apex:outputLabel>
                            <apex:outputText value="{0,Date,M'/'d'/'yyyy}">
                                <apex:param value="{!lastPaymentDate}" />
                            </apex:outputText>
                        </apex:pageBlockSectionItem>
                    </apex:pageBlockSection>
                        
                    <apex:pageBlockSection title="EPO Details" columns="1" collapsible="false">
                        <apex:dataTable value="{!sortedOLIWraps}" var="wrap" id="theTable" rowClasses="odd,even"  >
                            <apex:column width="250px">
                                <apex:facet name="header">Product</apex:facet>
                                <apex:outputLink value="/{!wrap.OLI.Id}" target="_parent">{!wrap.product}</apex:outputLink>
                            </apex:column>
                            <apex:column width="110px">
                                <apex:facet name="header">Amt Paid</apex:facet>
                                <apex:outputText value="{0,number,$###,###,##0.00}">
                                    <apex:param value="{!wrap.amtPaid}" />
                                </apex:outputText>
                            </apex:column>
                            <apex:column width="110px">
                                <apex:facet name="header">Amt Owed</apex:facet>
                                <apex:outputText value="{0,number,$###,###,##0.00}">
                                    <apex:param value="{!wrap.amtOwed}" />
                                </apex:outputText>
                            </apex:column>
                            <apex:column width="110px">
                                <apex:facet name="header">Last Pmt Amt</apex:facet>
                                <apex:outputText value="{0,number,$###,###,##0.00}">
                                    <apex:param value="{!wrap.lastPmtAmt}" />
                                </apex:outputText>
                            </apex:column>
                            <apex:column width="110px">
                                <apex:facet name="header">Last Pmt Date</apex:facet>
                                <apex:outputText value="{0,Date,M'/'d'/'yyyy}">
                                    <apex:param value="{!wrap.lastPmtDate}"/>
                                </apex:outputText>
                            </apex:column>
                            <apex:column width="110px">
                                <apex:facet name="header">Next Pmt Amt</apex:facet>
                                <apex:outputText value="{0,number,$###,###,##0.00}">
                                    <apex:param value="{!wrap.nextPmtAmt}"/>
                                </apex:outputText>
                            </apex:column>
                            <apex:column width="110px">
                                <apex:facet name="header">Next Pmt Date</apex:facet>
                                <apex:outputText value="{0,Date,M'/'d'/'yyyy}">
                                    <apex:param value="{!wrap.nextPmtDate}"/>
                                </apex:outputText>
                            </apex:column>
                        </apex:dataTable>
                    </apex:pageBlockSection>
                </apex:pageBlock>
            </apex:outputPanel>
            <apex:outputPanel layout="block" rendered="{!NOT(oppDataPresent)}" >
                <apex:outputText value="No opportunities for this account qualify for EPO." />
            </apex:outputPanel>
        </apex:form>
    </body>
</apex:page>