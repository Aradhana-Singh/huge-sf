<apex:page controller="AggregateViewCtrl" docType="html-5.0" readOnly="true">
<!-- Including Jquery and Css libraries -->
<apex:include pageName="TrackingCode"/>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56384246-1', 'auto');
  ga('send', 'pageview');
  
</script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56270885-2', 'auto');
  ga('send', 'pageview');

</script>

  <script src="https://code.jquery.com/jquery-1.8.2.js"></script>
    <script src="/soap/ajax/26.0/connection.js" type="text/javascript"></script> 
    <script src="https://code.jquery.com/ui/1.9.0/jquery-ui.js"></script>  
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css"/>  
        <!-- Jquery function to obtain List of Accounts to fill autocomplete. -->
    <script type="text/javascript">     
        var j$ = jQuery.noConflict();
        var apexUserList =[];
        
        <apex:repeat value="{!Options}" var="usrList">
            apexUserList.push('{!usrList}');
        </apex:repeat>
       
        j$(document).ready(function(){
            j$("#apexaccountautocomplete").autocomplete({
            source : apexUserList,
            autoFocus: true
            });
        }); 
         
        //Create a new variable j$ just to avoid any conflicts with other libraries which may be using $.
        var j$ = jQuery.noConflict();
        function setHidden(){
           j$("[id*='theHiddenInput']").val(j$("[id*='apexaccountautocomplete']").val());
        }
    </script>
   <apex:pageBlock >
       <!-- Displaying error message. 
           <apex:pageMessages id="errors" /> -->
           <apex:form >
               <apex:outputPanel id="accountFilter"> 
               
                   <span style="margin:10px;"><b>Choose Account</b></span>  
                    <!-- Input field for Account Name -->
                   <input id="apexaccountautocomplete" /> 
                   <apex:inputHidden value="{!account}" id="theHiddenInput"/> 
                    <!-- Input fields for Start Date and End Date -->
                   <span style="margin:10px;"><b>Start Week</b></span> 
                   <apex:input value="{!startDate}" id="theTextInput1" type="date" />
                   
                   <span style="margin:10px;"><b>End Week</b></span> 
                   <apex:input value="{!endDate}" id="theTextInput" type="date"/> 
                   
                   <apex:commandButton value="Run Report" action="{!go}" reRender="out" onclick="setHidden();"/> 
               </apex:outputPanel> <br/><br/>
             <!--  <apex:outputPanel id="out1" > 
                   Records {!Records}<br/>
                   Account {!account}<br/>
                   Start {!startDate}<br/>
                   End {!endDate}<br/>
               </apex:outputPanel> -->
               <apex:outputPanel id="out" > 
                   <!-- Displaying List of Account Records in Tabular Formate -->
                  <apex:pageBlock title="{!account}" rendered="{!Records}"  >
                  <apex:pageMessages ></apex:pageMessages>
                      <apex:pageBlocktable value="{!aggregateRecords }" var="a"> 
                           <apex:column value="{!a.Year__c }"/>
                           <apex:column value="{!a.WeekNumber__c}"/> 
                           <apex:column value="{!a.Cases__c }"/>
                           <apex:column value="{!a.Contacts__c }"/>
                           <apex:column value="{!a.OpportunitiesCW__c }"/>
                           <apex:column value="{!a.OpportunitiesCL__c }"/>
                           <apex:column value="{!a.OpportunitiesOP__c }"/>
                           <apex:column value="{!a.Opportunities__c }"/>  
                      </apex:pageBlocktable>  
                  </apex:pageBlock>
                </apex:outputPanel> 
           </apex:form> <br/> 
            
   </apex:pageBlock>
  <site:googleAnalyticsTracking />
</apex:page>